<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Panel Admin Target</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{background:#020617;color:#fff;font-family:Arial;padding:20px;}
table{width:100%;border-collapse:collapse;margin-top:20px;}
th,td{
  padding:10px;border-bottom:1px solid #334155;text-align:left;
}
tr:hover{ background:#1e293b; }
.map{
  width:100%;height:200px;border-radius:10px;margin-top:10px;
}
</style>
</head>
<body>

<h1>Admin â€“ Daftar Semua Target</h1>

<table>
<thead>
<tr>
  <th>User</th>
  <th>Lokasi</th>
  <th>Maps</th>
  <th>Waktu</th>
</tr>
</thead>
<tbody id="dataTable"></tbody>
</table>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js";
import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyDxgnLu6TtJce2hd1DL07z5MWo62blEgC8",
  authDomain: "simulasi-kamera.firebaseapp.com",
  databaseURL: "https://simulasi-kamera-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "simulasi-kamera",
  storageBucket: "simulasi-kamera.firebasestorage.app",
  messagingSenderId: "924924454534",
  appId: "1:924924454534:web:8a3c34079aa1b0edd9d307"
};

const app = initializeApp(firebaseConfig);
const db  = getDatabase(app);

onValue(ref(db, "targets"), snap => {
  const data = snap.val();
  const table = document.getElementById("dataTable");
  table.innerHTML = "";

  if(!data) return;

  Object.keys(data).forEach(user=>{
    const t = data[user];

    table.innerHTML += `
      <tr>
        <td>${user}</td>
        <td>${t.lat.toFixed(5)}, ${t.lon.toFixed(5)}</td>
        <td>
          <iframe class="map"
            src="https://www.google.com/maps?q=${t.lat},${t.lon}&z=15&output=embed">
          </iframe>
        </td>
        <td>${t.time}</td>
      </tr>
    `;
  });
});
</script>

</body>
</html>
